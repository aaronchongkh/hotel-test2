{"ast":null,"code":"var _jsxFileName = \"/Users/aaronchongkh/ReactProjects/hotel-test2/src/components/BookingForm.tsx\";\nimport React from 'react';\nimport { Redirect } from 'react-router';\nimport AWS from 'aws-sdk';\nimport Webcam from 'react-webcam'; // const AWS = require('aws-sdk');\n\nconst S3 = require('react-aws-s3');\n\nconst config = {\n  bucketName: 'facerecogdata2',\n  //dirName: 'media', /* optional */\n  region: 'us-east-2',\n  accessKeyId: 'AKIA2FBSYGBOR6A3TQGL',\n  secretAccessKey: 'myA5ldaLfSkcCwYKF6DiG4q5nG4lMkXmJCoyRKSp' // s3Url: 'https:/your-custom-s3-url.com/', /* optional */\n  // AWS.config = new AWS.config();\n  // AWS.config.accessKeyId = config.accessKeyId; \n  // AWS.config.secretAccessKey = config.secretAccessKey;\n  // AWS.config.region = config.region\n\n};\nvar s3Bucket = new AWS.S3({\n  params: {\n    Bucket: 'facerecogdata2'\n  }\n});\nAWS.config.update({\n  accessKeyId: 'AKIA2FBSYGBOR6A3TQGL',\n  secretAccessKey: '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',\n  region: 'us-east-2'\n});\nconst dynamoDb = new AWS.DynamoDB.DocumentClient({\n  accessKeyId: config.accessKeyId,\n  secretAccessKey: config.secretAccessKey,\n  region: config.region\n}); // dynamo.AWS.config.update({accessKeyId: config.accessKeyId, secretAccessKey: config.secretAccessKey, region: config.region});\n\nconst S3FileUpload = new S3(config); // const ddb = new AWS.DynamoDB({apiVersion: '2012-08-10'});\n\nexport class BookingForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.webcamRef = void 0;\n\n    this.handleCapture = () => {\n      var tempPhoto = this.webcamRef.current.getScreenshot();\n      this.setState({\n        previewImg: tempPhoto\n      });\n    };\n\n    this.handlePhotoUpload2 = () => {\n      const buffer = Buffer.from(this.state.previewImg.replace(/^data:image\\/\\w+;base64,/, \"\"), 'base64');\n      console.log(buffer);\n      var fnameString = this.state.fname;\n      var lnameString = this.state.lname;\n      var cusFullName = fnameString + \"_\" + lnameString;\n      var data = {\n        Key: cusFullName + \".jpeg\",\n        Body: buffer,\n        ContentEncoding: 'base64',\n        ContentType: 'image/jpeg',\n        Bucket: 'facerecogdata2'\n      };\n      s3Bucket.putObject(data, function (err, data) {\n        if (err) {\n          console.log(err);\n          console.log('Error uploading data: ', data);\n        } else {\n          console.log('succesfully uploaded the image!');\n        }\n      });\n    };\n\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleCapture = this.handleCapture.bind(this);\n    this.handlePhotoUpload = this.handlePhotoUpload.bind(this);\n    this.webcamRef = React.createRef();\n    this.state = {\n      startDate: new Date(),\n      endDate: new Date(),\n      noOfPeople: 1,\n      roomType: \"\",\n      fname: \"\",\n      lname: \"\",\n      email: \"\",\n      phoneno: \"\",\n      previewImg: null,\n      photoInput: false,\n      bookingRedirect: false\n    };\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      // const { startDate, endDate, noOfPeople, roomType } = this.props.location.state;\n      // console.log(startDate);\n      // console.log(endDate);\n      // console.log(noOfPeople);\n      // console.log(roomType);\n      this.setState({\n        startDate: this.props.startDate,\n        endDate: this.props.endDate,\n        noOfPeople: this.props.noOfPeople,\n        roomType: this.props.roomType,\n        fname: this.props.fname,\n        lname: this.props.lname,\n        email: this.props.email,\n        phoneno: this.props.phoneno\n      });\n      console.log(this.state.noOfPeople);\n      console.log(this.state.roomType);\n      console.log(this.state.startDate);\n      console.log(this.state.endDate);\n    }, 1000);\n  }\n\n  photoSelection() {\n    let numOfSel = [];\n\n    for (let i = 1; i <= this.props.noOfPeople; i++) {\n      numOfSel.push(React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }, \"Person number \", i, \":\", React.createElement(\"input\", {\n        type: \"file\",\n        name: \"file\",\n        onChange: this.handlePhotoUpload,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      })));\n    }\n\n    return numOfSel;\n  }\n\n  renderPhotoSelection() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, this.photoSelection());\n  }\n\n  handleSubmit(e) {\n    // e.preventDefault();\n    this.setState({\n      fname: this.refs.fname.value,\n      lname: this.refs.lname.value,\n      email: this.refs.email.value,\n      phoneno: this.refs.phoneno.value\n    });\n    console.log(this.state.fname);\n    var fnameString = this.state.fname;\n    var lnameString = this.state.lname;\n    var cusFullName = fnameString + \"_\" + lnameString;\n    var endDateString = this.state.endDate.toDateString().split(' ').slice(1).join(' ');\n    var startDateString = this.state.startDate.toDateString().split(' ').slice(1).join(' ');\n    var emailString = this.state.email;\n    var phonenoString = this.state.phoneno;\n    var roomTypeString = this.state.roomType;\n    var noOfPeopleString = this.state.noOfPeople;\n    console.log(this.state);\n    console.log(cusFullName);\n    var defaultRoomNumber = 0;\n    var params = {\n      TableName: 'HotelCustomer',\n      Item: {\n        // 'fName': {\"S\": this.state.fname}, \n        // 'lName': {\"S\": this.state.lname}, \n        // 'startDate': {\"S\": this.state.startDate.toISOString()}, \n        // 'endDate': {\"S\": this.state.endDate.toISOString()}, \n        // 'roomType': {\"S\": this.state.roomType}, \n        // 'fullName': {\"S\": cusFullName}, \n        // 'email': {\"S\": this.state.email}, \n        // 'phoneno': {\"S\": this.state.phoneno},\n        // 'noOfPeople': {\"S\": this.state.noOfPeople}\n        fName: fnameString,\n        lName: lnameString,\n        email: emailString,\n        endDate: endDateString,\n        fullName: cusFullName,\n        phoneno: phonenoString,\n        roomType: roomTypeString,\n        startDate: startDateString,\n        noOfPeople: noOfPeopleString,\n        roomNumber: defaultRoomNumber.toString()\n      }\n    };\n    dynamoDb.put(params, (err, data) => {\n      if (err) {\n        console.log(\"Error\", err);\n        window.alert(\"Can't upload data, please try again. \");\n      } else {\n        console.log(\"Success\", data);\n        this.setState({\n          bookingRedirect: true\n        });\n      }\n    }); // setTimeout(() => {\n    //     //bac\n    // }, 300)\n  }\n\n  handleFirstName(e) {\n    this.setState({\n      fname: e\n    });\n  }\n\n  handleLastName(e) {\n    this.setState({\n      lname: e\n    });\n  }\n\n  handleEmail(e) {\n    this.setState({\n      email: e\n    });\n  }\n\n  handlePhone(e) {\n    this.setState({\n      phoneno: e\n    });\n  }\n\n  handlePhotoUpload(e) {\n    var fnameString = this.state.fname;\n    var lnameString = this.state.lname;\n    var fullName = fnameString + \"_\" + lnameString;\n    let file = e.target.files[0];\n    let reader = new FileReader();\n\n    if (e.target.files.length === 0) {\n      return;\n    }\n\n    console.log(e.target.files[0]);\n\n    reader.onloadend = e => {\n      this.setState({\n        previewImg: [reader.result]\n      });\n    };\n\n    const file_name = fullName;\n    S3FileUpload.uploadFile(e.target.files[0], file_name).then(data => console.log(data), window.alert(\"Uploaded\")).catch(err => console.error(err));\n    const abc = reader.readAsDataURL(file);\n    this.setState({\n      photoInput: true\n    });\n  }\n\n  render() {\n    const bookingRedirect = this.state.bookingRedirect;\n    console.log(this.state);\n\n    if (bookingRedirect) {\n      return React.createElement(Redirect, {\n        to: \"/bookingcomplete\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      });\n    } else {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"banner\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274\n        },\n        __self: this\n      }, \"Room details: \"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275\n        },\n        __self: this\n      }, \"Room type selected: \", this.props.roomType), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276\n        },\n        __self: this\n      }, \"Start date: \", this.props.startDate.toDateString()), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        },\n        __self: this\n      }, \"End date: \", this.props.endDate.toDateString())), React.createElement(\"form\", {\n        onSubmit: e => this.handleSubmit(e),\n        noValidate: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 279\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282\n        },\n        __self: this\n      }, \"First Name: \", React.createElement(\"input\", {\n        ref: \"fname\",\n        placeholder: \"Enter first name\",\n        type: \"text\",\n        onChange: e => this.handleFirstName(e.target.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282\n        },\n        __self: this\n      }), \" Last Name: \", React.createElement(\"input\", {\n        ref: \"lname\",\n        placeholder: \"Enter last name\",\n        type: \"text\",\n        onChange: e => this.handleLastName(e.target.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      }, \"Email address: \", React.createElement(\"input\", {\n        ref: \"email\",\n        placeholder: \"Enter email address\",\n        type: \"email\",\n        onChange: e => this.handleEmail(e.target.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      }, \"Phone number: \", React.createElement(\"input\", {\n        ref: \"phoneno\",\n        placeholder: \"Enter phone number\",\n        type: \"number\",\n        onChange: e => this.handlePhone(e.target.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      })), React.createElement(Webcam, {\n        height: 360,\n        width: 720,\n        screenshotFormat: \"image/jpeg\",\n        audio: false,\n        ref: this.webcamRef,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.handleCapture,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294\n        },\n        __self: this\n      }, \"Capture photo\"), React.createElement(\"button\", {\n        onClick: this.handlePhotoUpload2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }, \"Upload photo\")), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: this.state.previewImg,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        className: \"btn-primary\",\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300\n        },\n        __self: this\n      }, \"Finish booking\")))));\n    }\n  }\n\n}\nexport default BookingForm;","map":{"version":3,"sources":["/Users/aaronchongkh/ReactProjects/hotel-test2/src/components/BookingForm.tsx"],"names":["React","Redirect","AWS","Webcam","S3","require","config","bucketName","region","accessKeyId","secretAccessKey","s3Bucket","params","Bucket","update","dynamoDb","DynamoDB","DocumentClient","S3FileUpload","BookingForm","Component","constructor","props","webcamRef","handleCapture","tempPhoto","current","getScreenshot","setState","previewImg","handlePhotoUpload2","buffer","Buffer","from","state","replace","console","log","fnameString","fname","lnameString","lname","cusFullName","data","Key","Body","ContentEncoding","ContentType","putObject","err","handleSubmit","bind","handlePhotoUpload","createRef","startDate","Date","endDate","noOfPeople","roomType","email","phoneno","photoInput","bookingRedirect","componentDidMount","setTimeout","photoSelection","numOfSel","i","push","renderPhotoSelection","e","refs","value","endDateString","toDateString","split","slice","join","startDateString","emailString","phonenoString","roomTypeString","noOfPeopleString","defaultRoomNumber","TableName","Item","fName","lName","fullName","roomNumber","toString","put","window","alert","handleFirstName","handleLastName","handleEmail","handlePhone","file","target","files","reader","FileReader","length","onloadend","result","file_name","uploadFile","then","catch","error","abc","readAsDataURL","render"],"mappings":"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","sourcesContent":["import React, { Props } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Redirect } from 'react-router';\nimport { ReactComponent } from '*.svg';\nimport { IState } from '../models/models';\nimport Moment from 'react-moment';\nimport dynamo from 'dynamodb';\nimport AWS, { DynamoDB } from 'aws-sdk';\nimport Webcam, { WebcamProps } from 'react-webcam';\n// const AWS = require('aws-sdk');\nconst S3 = require('react-aws-s3');\n\ninterface LState {\n    startDate: Date;\n    endDate: Date;\n    noOfPeople: number;\n    roomType?: string;\n    fname?: string; \n    lname?: string; \n    email?: string; \n    phoneno?: string; \n}\n\nconst config = {\n    bucketName: 'facerecogdata2',\n    //dirName: 'media', /* optional */\n    region: 'us-east-2',\n    accessKeyId: 'AKIA2FBSYGBOR6A3TQGL',\n    secretAccessKey: 'myA5ldaLfSkcCwYKF6DiG4q5nG4lMkXmJCoyRKSp',\n    // s3Url: 'https:/your-custom-s3-url.com/', /* optional */\n}\n\n// AWS.config = new AWS.config();\n// AWS.config.accessKeyId = config.accessKeyId; \n// AWS.config.secretAccessKey = config.secretAccessKey;\n// AWS.config.region = config.region\n\nvar s3Bucket = new AWS.S3( { params: {Bucket: 'facerecogdata2'} } );\n\nAWS.config.update({accessKeyId: 'AKIA2FBSYGBOR6A3TQGL', secretAccessKey: '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', region: 'us-east-2'});\nconst dynamoDb = new AWS.DynamoDB.DocumentClient({accessKeyId: config.accessKeyId, secretAccessKey: config.secretAccessKey, region: config.region});\n\n// dynamo.AWS.config.update({accessKeyId: config.accessKeyId, secretAccessKey: config.secretAccessKey, region: config.region});\n\nconst S3FileUpload = new S3(config);\n// const ddb = new AWS.DynamoDB({apiVersion: '2012-08-10'});\n\nexport class BookingForm extends React.Component<LState, IState> {\n    private webcamRef: React.RefObject<Webcam> & React.RefObject<HTMLVideoElement>;\n    constructor(props: Readonly<LState>) {\n        super(props);\n        this.handleSubmit = this.handleSubmit.bind(this)\n        this.handleCapture = this.handleCapture.bind(this)\n        this.handlePhotoUpload = this.handlePhotoUpload.bind(this)\n        this.webcamRef = React.createRef();\n\n        this.state = {\n            startDate: new Date(), \n            endDate: new Date(),\n            noOfPeople: 1, \n            roomType: \"\",\n            fname: \"\",\n            lname: \"\", \n            email: \"\", \n            phoneno: \"\", \n            previewImg: null, \n            photoInput: false,\n            bookingRedirect: false\n        }\n    }\n\n    componentDidMount() {\n        setTimeout(() => {\n            // const { startDate, endDate, noOfPeople, roomType } = this.props.location.state;\n            // console.log(startDate);\n            // console.log(endDate);\n            // console.log(noOfPeople);\n            // console.log(roomType);\n\n        this.setState({\n            startDate: this.props.startDate,\n            endDate: this.props.endDate,\n            noOfPeople: this.props.noOfPeople,\n            roomType: this.props.roomType,\n            fname: this.props.fname,\n            lname: this.props.lname,\n            email: this.props.email,\n            phoneno: this.props.phoneno\n        })\n        console.log(this.state.noOfPeople);\n        console.log(this.state.roomType);\n        console.log(this.state.startDate);\n        console.log(this.state.endDate);\n        }, 1000)\n    }\n\n    public photoSelection() {\n        let numOfSel: Array<JSX.Element> = [];\n        for(let i = 1; i <= this.props.noOfPeople; i++) {\n            numOfSel.push(<div>Person number {i}:<input type=\"file\" name=\"file\" onChange={this.handlePhotoUpload} /></div>)\n        }\n        return numOfSel;\n    }\n\n    public renderPhotoSelection() {\n        \n        return <div>\n            {this.photoSelection()}\n        </div>\n    }\n\n    handleCapture = () => {\n        var tempPhoto = this.webcamRef.current.getScreenshot();\n        this.setState({\n            previewImg: tempPhoto\n        });\n    }\n\n    handlePhotoUpload2 = () => {\n        const buffer = Buffer.from(this.state.previewImg.replace(/^data:image\\/\\w+;base64,/, \"\"),'base64');\n        console.log(buffer);\n        var fnameString = this.state.fname; \n        var lnameString = this.state.lname; \n        var cusFullName = fnameString + \"_\" + lnameString;\n        var data = {\n            Key: cusFullName + \".jpeg\", \n            Body: buffer,\n            ContentEncoding: 'base64',\n            ContentType: 'image/jpeg', \n            Bucket: 'facerecogdata2'\n        };\n        s3Bucket.putObject(data, function(err, data){\n            if (err) { \n                console.log(err);\n                console.log('Error uploading data: ', data); \n            } else {\n                console.log('succesfully uploaded the image!');\n            }\n        });\n    }\n\n    public handleSubmit(e: React.FormEvent<HTMLFormElement>) {\n        // e.preventDefault();\n        this.setState({\n            fname: (this.refs.fname as HTMLInputElement).value, \n            lname: (this.refs.lname as HTMLInputElement).value,\n            email: (this.refs.email as HTMLInputElement).value, \n            phoneno: (this.refs.phoneno as HTMLInputElement).value\n        })\n        console.log(this.state.fname);\n\n        var fnameString = this.state.fname; \n        var lnameString = this.state.lname; \n        var cusFullName = fnameString + \"_\" + lnameString; \n        var endDateString = this.state.endDate.toDateString().split(' ').slice(1).join(' ');\n        var startDateString = this.state.startDate.toDateString().split(' ').slice(1).join(' ');\n        var emailString = this.state.email;\n        var phonenoString = this.state.phoneno;\n        var roomTypeString = this.state.roomType;\n        var noOfPeopleString = this.state.noOfPeople;\n\n        console.log(this.state);\n        console.log(cusFullName);\n        \n        var defaultRoomNumber = 0;\n\n        var params = {\n            TableName: 'HotelCustomer', \n            Item: {\n                // 'fName': {\"S\": this.state.fname}, \n                // 'lName': {\"S\": this.state.lname}, \n                // 'startDate': {\"S\": this.state.startDate.toISOString()}, \n                // 'endDate': {\"S\": this.state.endDate.toISOString()}, \n                // 'roomType': {\"S\": this.state.roomType}, \n                // 'fullName': {\"S\": cusFullName}, \n                // 'email': {\"S\": this.state.email}, \n                // 'phoneno': {\"S\": this.state.phoneno},\n                // 'noOfPeople': {\"S\": this.state.noOfPeople}\n                fName: fnameString,\n                lName: lnameString,\n                email: emailString, \n                endDate: endDateString, \n                fullName: cusFullName, \n                phoneno: phonenoString, \n                roomType: roomTypeString, \n                startDate: startDateString, \n                noOfPeople: noOfPeopleString, \n                roomNumber: defaultRoomNumber.toString()\n            }\n        }; \n\n        dynamoDb.put(params, (err, data) => {\n            if (err) {\n                console.log(\"Error\", err); \n                window.alert(\"Can't upload data, please try again. \")\n            } else {\n                console.log(\"Success\", data);\n                this.setState({\n                    bookingRedirect: true\n                })  \n            }\n        });\n\n        \n\n        // setTimeout(() => {\n        //     //bac\n        // }, 300)\n    }\n\n    public handleFirstName(e: string): void {\n        this.setState({\n            fname: e\n        })\n    }\n\n    public handleLastName(e: string): void {\n        this.setState({\n            lname: e\n        })\n    }\n\n    public handleEmail(e: string): void {\n        this.setState({\n            email: e\n        })\n    }\n\n    public handlePhone(e: string): void {\n        this.setState({\n            phoneno: e\n        })\n    }\n\n    public handlePhotoUpload(e: any): void {\n        var fnameString = this.state.fname; \n        var lnameString = this.state.lname; \n        var fullName = fnameString + \"_\" + lnameString; \n\n        let file = e.target.files[0];\n        let reader = new FileReader();\n\n        if (e.target.files.length === 0) {\n            return;\n        }\n\n        console.log(e.target.files[0]);\n        reader.onloadend = (e) => {\n            this.setState({\n                previewImg: [reader.result]\n            });\n        }\n        const file_name = fullName;\n\n        S3FileUpload.uploadFile(e.target.files[0], file_name).then((data: any) => console.log(data), window.alert(\"Uploaded\")).catch((err: any) => console.error(err));\n\n        const abc = reader.readAsDataURL(file);\n\n        this.setState({\n            photoInput: true\n        })\n    }\n\n    public render(): JSX.Element {\n        const bookingRedirect = this.state.bookingRedirect;\n        console.log(this.state);\n        \n        if (bookingRedirect) {\n            return <Redirect to='/bookingcomplete' />\n        }\n        else {\n            return <div>\n            <div className=\"banner\">\n                <h2>Room details: </h2>\n                <p>Room type selected: {this.props.roomType}</p>\n                <p>Start date: {this.props.startDate.toDateString()}</p>\n                <p>End date: {this.props.endDate.toDateString()}</p>\n            </div>\n            <form onSubmit={(e) => this.handleSubmit(e)} noValidate={true}>\n            <div className=\"container\">\n                <div className=\"form-group\">\n                    <p>First Name: <input ref='fname' placeholder= \"Enter first name\" type=\"text\" onChange={e => this.handleFirstName(e.target.value)}></input> Last Name: <input ref='lname' placeholder= \"Enter last name\" type=\"text\" onChange={e => this.handleLastName(e.target.value)}></input></p>\n                    <p>Email address: <input ref='email' placeholder=\"Enter email address\" type=\"email\" onChange={e => this.handleEmail(e.target.value)}></input></p>\n                    <p>Phone number: <input ref='phoneno' placeholder=\"Enter phone number\" type=\"number\" onChange={e => this.handlePhone(e.target.value)}></input></p>\n                    {/* {this.renderPhotoSelection()} */}\n                    <Webcam \n                        height={360}\n                        width={720}\n                        screenshotFormat=\"image/jpeg\"\n                        audio={false}\n                        ref={this.webcamRef}\n                        />\n                    <div>\n                        <button onClick={this.handleCapture}>Capture photo</button>\n                        <button onClick={this.handlePhotoUpload2}>Upload photo</button>\n                    </div>\n                    <div>\n                        <img src={this.state.previewImg} />\n                    </div>\n                    <button className=\"btn-primary\" type=\"submit\">Finish booking</button>\n                </div>\n            </div>\n            </form>\n            </div>\n        }\n    }\n}\n\nexport default BookingForm;\n"]},"metadata":{},"sourceType":"module"}