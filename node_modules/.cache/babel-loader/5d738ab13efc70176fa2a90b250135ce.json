{"ast":null,"code":"var _jsxFileName = \"/Users/aaronchongkh/ReactProjects/hotel-test2/src/components/BookingForm.tsx\";\nimport React from 'react';\nimport { Redirect } from 'react-router';\nimport AWS from 'aws-sdk'; // const AWS = require('aws-sdk');\n\nconst S3 = require('react-aws-s3');\n\nconst config = {\n  bucketName: 'facerecogdata2',\n  //dirName: 'media', /* optional */\n  region: 'us-east-2',\n  accessKeyId: 'AKIA2FBSYGBOR6A3TQGL',\n  secretAccessKey: 'myA5ldaLfSkcCwYKF6DiG4q5nG4lMkXmJCoyRKSp' // s3Url: 'https:/your-custom-s3-url.com/', /* optional */\n  // AWS.config = new AWS.config();\n  // AWS.config.accessKeyId = config.accessKeyId; \n  // AWS.config.secretAccessKey = config.secretAccessKey;\n  // AWS.config.region = config.region\n\n};\nAWS.config.update({\n  accessKeyId: 'AKIA2FBSYGBOR6A3TQGL',\n  secretAccessKey: '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',\n  region: 'us-east-2'\n});\nconst dynamoDb = new AWS.DynamoDB.DocumentClient({\n  accessKeyId: config.accessKeyId,\n  secretAccessKey: config.secretAccessKey,\n  region: config.region\n}); // dynamo.AWS.config.update({accessKeyId: config.accessKeyId, secretAccessKey: config.secretAccessKey, region: config.region});\n\nconst S3FileUpload = new S3(config); // const ddb = new AWS.DynamoDB({apiVersion: '2012-08-10'});\n\nexport class BookingForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.state = {\n      startDate: new Date(),\n      endDate: new Date(),\n      noOfPeople: 1,\n      roomType: \"\",\n      fname: \"\",\n      lname: \"\",\n      email: \"\",\n      phoneno: \"\",\n      previewImg: \"\",\n      photoInput: false,\n      bookingRedirect: false\n    };\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      // const { startDate, endDate, noOfPeople, roomType } = this.props.location.state;\n      // console.log(startDate);\n      // console.log(endDate);\n      // console.log(noOfPeople);\n      // console.log(roomType);\n      this.setState({\n        startDate: this.props.startDate,\n        endDate: this.props.endDate,\n        noOfPeople: this.props.noOfPeople,\n        roomType: this.props.roomType,\n        fname: this.props.fname,\n        lname: this.props.lname,\n        email: this.props.email,\n        phoneno: this.props.phoneno\n      });\n      console.log(this.state.noOfPeople);\n      console.log(this.state.roomType);\n      console.log(this.state.startDate);\n      console.log(this.state.endDate);\n    }, 1000);\n  }\n\n  photoSelection() {\n    let numOfSel = [];\n\n    for (let i = 1; i <= this.props.noOfPeople; i++) {\n      numOfSel.push(React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, \"Person number \", i, \": \", React.createElement(\"input\", {\n        type: \"file\",\n        name: \"file\",\n        onChange: this.handlePhotoUpload,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      })));\n    }\n\n    return numOfSel;\n  }\n\n  renderPhotoSelection() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, this.photoSelection());\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    this.setState({\n      fname: this.refs.fname.value,\n      lname: this.refs.lname.value,\n      email: this.refs.email.value,\n      phoneno: this.refs.phoneno.value\n    });\n    console.log(this.state.fname);\n    var fnameString = this.state.fname;\n    var lnameString = this.state.lname;\n    var cusFullName = fnameString + \"_\" + lnameString;\n    var endDateString = this.state.endDate.toDateString().split(' ').slice(1).join(' ');\n    var startDateString = this.state.startDate.toDateString().split(' ').slice(1).join(' ');\n    var emailString = this.state.email;\n    var phonenoString = this.state.phoneno;\n    var roomTypeString = this.state.roomType;\n    var noOfPeopleString = this.state.noOfPeople;\n    console.log(this.state);\n    console.log(cusFullName);\n    var params = {\n      TableName: 'HotelCustomer',\n      Item: {\n        // 'fName': {\"S\": this.state.fname}, \n        // 'lName': {\"S\": this.state.lname}, \n        // 'startDate': {\"S\": this.state.startDate.toISOString()}, \n        // 'endDate': {\"S\": this.state.endDate.toISOString()}, \n        // 'roomType': {\"S\": this.state.roomType}, \n        // 'fullName': {\"S\": cusFullName}, \n        // 'email': {\"S\": this.state.email}, \n        // 'phoneno': {\"S\": this.state.phoneno},\n        // 'noOfPeople': {\"S\": this.state.noOfPeople}\n        fName: fnameString,\n        lName: lnameString,\n        email: emailString,\n        endDate: endDateString,\n        fullName: cusFullName,\n        phoneno: phonenoString,\n        roomType: roomTypeString,\n        startDate: startDateString,\n        noOfPeople: noOfPeopleString,\n        roomNumber: 0\n      }\n    };\n    dynamoDb.put(params, (err, data) => {\n      if (err) {\n        console.log(\"Error\", err);\n        window.alert(\"Can't upload data, please try again. \");\n      } else {\n        console.log(\"Success\", data);\n        this.setState({\n          bookingRedirect: true\n        });\n      }\n    }); // setTimeout(() => {\n    //     //bac\n    // }, 300)\n  }\n\n  handleFirstName(e) {\n    this.setState({\n      fname: e\n    });\n  }\n\n  handleLastName(e) {\n    this.setState({\n      lname: e\n    });\n  }\n\n  handleEmail(e) {\n    this.setState({\n      email: e\n    });\n  }\n\n  handlePhone(e) {\n    this.setState({\n      phoneno: e\n    });\n  }\n\n  handlePhotoUpload(e) {\n    var fnameString = this.state.fname;\n    var lnameString = this.state.lname;\n    var fullName = fnameString + \"_\" + lnameString;\n    let file = e.target.files[0];\n    let reader = new FileReader();\n\n    if (e.target.files.length === 0) {\n      return;\n    }\n\n    console.log(e.target.files[0]);\n\n    reader.onloadend = e => {\n      this.setState({\n        previewImg: [reader.result]\n      });\n    };\n\n    const file_name = fullName;\n    S3FileUpload.uploadFile(e.target.files[0], file_name).then(data => console.log(data), window.alert(\"Uploaded\")).catch(err => console.error(err));\n    const abc = reader.readAsDataURL(file);\n    this.setState({\n      photoInput: true\n    });\n  }\n\n  render() {\n    const bookingRedirect = this.state.bookingRedirect;\n    console.log(this.state);\n\n    if (bookingRedirect) {\n      return React.createElement(Redirect, {\n        to: \"/bookingcomplete\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      });\n    } else {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"banner\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, \"Room details: \"), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }, \"Room type selected: \", this.props.roomType), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, \"Start date: \", this.props.startDate.toDateString()), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      }, \"End date: \", this.props.endDate.toDateString())), React.createElement(\"form\", {\n        onSubmit: e => this.handleSubmit(e),\n        noValidate: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, \"First Name: \", React.createElement(\"input\", {\n        ref: \"fname\",\n        placeholder: \"Enter first name\",\n        type: \"text\",\n        onChange: e => this.handleFirstName(e.target.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }), \" Last Name: \", React.createElement(\"input\", {\n        ref: \"lname\",\n        placeholder: \"Enter last name\",\n        type: \"text\",\n        onChange: e => this.handleLastName(e.target.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }, \"Email address: \", React.createElement(\"input\", {\n        ref: \"email\",\n        placeholder: \"Enter email address\",\n        type: \"email\",\n        onChange: e => this.handleEmail(e.target.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, \"Phone number: \", React.createElement(\"input\", {\n        ref: \"phoneno\",\n        placeholder: \"Enter phone number\",\n        type: \"number\",\n        onChange: e => this.handlePhone(e.target.value),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      })), this.renderPhotoSelection(), React.createElement(\"button\", {\n        className: \"btn-primary\",\n        type: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      }, \"Finish booking\")))));\n    }\n  }\n\n}\nexport default BookingForm;","map":{"version":3,"sources":["/Users/aaronchongkh/ReactProjects/hotel-test2/src/components/BookingForm.tsx"],"names":["React","Redirect","AWS","S3","require","config","bucketName","region","accessKeyId","secretAccessKey","update","dynamoDb","DynamoDB","DocumentClient","S3FileUpload","BookingForm","Component","constructor","props","handleSubmit","bind","state","startDate","Date","endDate","noOfPeople","roomType","fname","lname","email","phoneno","previewImg","photoInput","bookingRedirect","componentDidMount","setTimeout","setState","console","log","photoSelection","numOfSel","i","push","handlePhotoUpload","renderPhotoSelection","e","preventDefault","refs","value","fnameString","lnameString","cusFullName","endDateString","toDateString","split","slice","join","startDateString","emailString","phonenoString","roomTypeString","noOfPeopleString","params","TableName","Item","fName","lName","fullName","roomNumber","put","err","data","window","alert","handleFirstName","handleLastName","handleEmail","handlePhone","file","target","files","reader","FileReader","length","onloadend","result","file_name","uploadFile","then","catch","error","abc","readAsDataURL","render"],"mappings":"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","sourcesContent":["import React, { Props } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Redirect } from 'react-router';\nimport { ReactComponent } from '*.svg';\nimport { IState } from '../models/models';\nimport Moment from 'react-moment';\nimport dynamo from 'dynamodb';\nimport AWS, { DynamoDB } from 'aws-sdk';\n// const AWS = require('aws-sdk');\nconst S3 = require('react-aws-s3');\n\ninterface LState {\n    startDate: Date;\n    endDate: Date;\n    noOfPeople: number;\n    roomType?: string;\n    fname?: string; \n    lname?: string; \n    email?: string; \n    phoneno?: string; \n}\n\nconst config = {\n    bucketName: 'facerecogdata2',\n    //dirName: 'media', /* optional */\n    region: 'us-east-2',\n    accessKeyId: 'AKIA2FBSYGBOR6A3TQGL',\n    secretAccessKey: 'myA5ldaLfSkcCwYKF6DiG4q5nG4lMkXmJCoyRKSp',\n    // s3Url: 'https:/your-custom-s3-url.com/', /* optional */\n}\n\n// AWS.config = new AWS.config();\n// AWS.config.accessKeyId = config.accessKeyId; \n// AWS.config.secretAccessKey = config.secretAccessKey;\n// AWS.config.region = config.region\n\nAWS.config.update({accessKeyId: 'AKIA2FBSYGBOR6A3TQGL', secretAccessKey: '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', region: 'us-east-2'});\nconst dynamoDb = new AWS.DynamoDB.DocumentClient({accessKeyId: config.accessKeyId, secretAccessKey: config.secretAccessKey, region: config.region});\n\n// dynamo.AWS.config.update({accessKeyId: config.accessKeyId, secretAccessKey: config.secretAccessKey, region: config.region});\n\nconst S3FileUpload = new S3(config);\n// const ddb = new AWS.DynamoDB({apiVersion: '2012-08-10'});\n\nexport class BookingForm extends React.Component<LState, IState> {\n    constructor(props: Readonly<LState>) {\n        super(props);\n        this.handleSubmit = this.handleSubmit.bind(this)\n\n        this.state = {\n            startDate: new Date(), \n            endDate: new Date(),\n            noOfPeople: 1, \n            roomType: \"\",\n            fname: \"\",\n            lname: \"\", \n            email: \"\", \n            phoneno: \"\", \n            previewImg: \"\", \n            photoInput: false,\n            bookingRedirect: false\n        }\n    }\n\n    componentDidMount() {\n        setTimeout(() => {\n            // const { startDate, endDate, noOfPeople, roomType } = this.props.location.state;\n            // console.log(startDate);\n            // console.log(endDate);\n            // console.log(noOfPeople);\n            // console.log(roomType);\n\n        this.setState({\n            startDate: this.props.startDate,\n            endDate: this.props.endDate,\n            noOfPeople: this.props.noOfPeople,\n            roomType: this.props.roomType,\n            fname: this.props.fname,\n            lname: this.props.lname,\n            email: this.props.email,\n            phoneno: this.props.phoneno\n        })\n        console.log(this.state.noOfPeople);\n        console.log(this.state.roomType);\n        console.log(this.state.startDate);\n        console.log(this.state.endDate);\n        }, 1000)\n    }\n\n    public photoSelection() {\n        let numOfSel: Array<JSX.Element> = [];\n        for(let i = 1; i <= this.props.noOfPeople; i++) {\n            numOfSel.push(<div>Person number {i}: <input type=\"file\" name=\"file\" onChange={this.handlePhotoUpload}/></div>)\n        }\n        return numOfSel;\n    }\n\n    public renderPhotoSelection() {\n        \n        return <div>\n            {this.photoSelection()}\n        </div>\n    }\n\n    public handleSubmit(e: React.FormEvent<HTMLFormElement>) {\n        e.preventDefault();\n        this.setState({\n            fname: (this.refs.fname as HTMLInputElement).value, \n            lname: (this.refs.lname as HTMLInputElement).value,\n            email: (this.refs.email as HTMLInputElement).value, \n            phoneno: (this.refs.phoneno as HTMLInputElement).value\n        })\n        console.log(this.state.fname);\n\n        var fnameString = this.state.fname; \n        var lnameString = this.state.lname; \n        var cusFullName = fnameString + \"_\" + lnameString; \n        var endDateString = this.state.endDate.toDateString().split(' ').slice(1).join(' ');\n        var startDateString = this.state.startDate.toDateString().split(' ').slice(1).join(' ');\n        var emailString = this.state.email;\n        var phonenoString = this.state.phoneno;\n        var roomTypeString = this.state.roomType;\n        var noOfPeopleString = this.state.noOfPeople;\n\n        console.log(this.state);\n        console.log(cusFullName);\n        \n\n        var params = {\n            TableName: 'HotelCustomer', \n            Item: {\n                // 'fName': {\"S\": this.state.fname}, \n                // 'lName': {\"S\": this.state.lname}, \n                // 'startDate': {\"S\": this.state.startDate.toISOString()}, \n                // 'endDate': {\"S\": this.state.endDate.toISOString()}, \n                // 'roomType': {\"S\": this.state.roomType}, \n                // 'fullName': {\"S\": cusFullName}, \n                // 'email': {\"S\": this.state.email}, \n                // 'phoneno': {\"S\": this.state.phoneno},\n                // 'noOfPeople': {\"S\": this.state.noOfPeople}\n                fName: fnameString,\n                lName: lnameString,\n                email: emailString, \n                endDate: endDateString, \n                fullName: cusFullName, \n                phoneno: phonenoString, \n                roomType: roomTypeString, \n                startDate: startDateString, \n                noOfPeople: noOfPeopleString, \n                roomNumber: 0\n            }\n        }; \n\n        dynamoDb.put(params, (err, data) => {\n            if (err) {\n                console.log(\"Error\", err); \n                window.alert(\"Can't upload data, please try again. \")\n            } else {\n                console.log(\"Success\", data);\n                this.setState({\n                    bookingRedirect: true\n                })  \n            }\n        });\n\n        \n\n        // setTimeout(() => {\n        //     //bac\n        // }, 300)\n    }\n\n    public handleFirstName(e: string): void {\n        this.setState({\n            fname: e\n        })\n    }\n\n    public handleLastName(e: string): void {\n        this.setState({\n            lname: e\n        })\n    }\n\n    public handleEmail(e: string): void {\n        this.setState({\n            email: e\n        })\n    }\n\n    public handlePhone(e: string): void {\n        this.setState({\n            phoneno: e\n        })\n    }\n\n    public handlePhotoUpload(e: any): void {\n        var fnameString = this.state.fname; \n        var lnameString = this.state.lname; \n        var fullName = fnameString + \"_\" + lnameString; \n\n        let file = e.target.files[0];\n        let reader = new FileReader();\n\n        if (e.target.files.length === 0) {\n            return;\n        }\n\n        console.log(e.target.files[0]);\n        reader.onloadend = (e) => {\n            this.setState({\n                previewImg: [reader.result]\n            });\n        }\n        const file_name = fullName;\n\n        S3FileUpload.uploadFile(e.target.files[0], file_name).then((data: any) => console.log(data), window.alert(\"Uploaded\")).catch((err: any) => console.error(err));\n\n        const abc = reader.readAsDataURL(file);\n\n        this.setState({\n            photoInput: true\n        })\n    }\n\n    public render(): JSX.Element {\n        const bookingRedirect = this.state.bookingRedirect;\n        console.log(this.state);\n        \n        if (bookingRedirect) {\n            return <Redirect to='/bookingcomplete' />\n        }\n        else {\n            return <div>\n            <div className=\"banner\">\n                <h2>Room details: </h2>\n                <p>Room type selected: {this.props.roomType}</p>\n                <p>Start date: {this.props.startDate.toDateString()}</p>\n                <p>End date: {this.props.endDate.toDateString()}</p>\n            </div>\n            <form onSubmit={(e) => this.handleSubmit(e)} noValidate={true}>\n            <div className=\"container\">\n                <div className=\"form-group\">\n                    <p>First Name: <input ref='fname' placeholder= \"Enter first name\" type=\"text\" onChange={e => this.handleFirstName(e.target.value)}></input> Last Name: <input ref='lname' placeholder= \"Enter last name\" type=\"text\" onChange={e => this.handleLastName(e.target.value)}></input></p>\n                    <p>Email address: <input ref='email' placeholder=\"Enter email address\" type=\"email\" onChange={e => this.handleEmail(e.target.value)}></input></p>\n                    <p>Phone number: <input ref='phoneno' placeholder=\"Enter phone number\" type=\"number\" onChange={e => this.handlePhone(e.target.value)}></input></p>\n                    {this.renderPhotoSelection()}\n                    <button className=\"btn-primary\" type=\"submit\">Finish booking</button>\n                </div>\n            </div>\n            </form>\n            </div>\n        }\n    }\n}\n\nexport default BookingForm;\n"]},"metadata":{},"sourceType":"module"}